package com.spark.utils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.io.IOException;import java.io.InputStream;public class SparkUtils {    private static Logger logger = LoggerFactory.getLogger(SparkUtils.class);    /**     * 执行字符串命令，获取执行命令后的返回结果     * @param cmds     * @return 执行命令后的返回结果     */    public static String execSubmitShell(String cmds){        String execResStr = "";        try {            Process execResPro = Runtime.getRuntime().exec(cmds);            InputStream is = execResPro.getInputStream();            execResStr = inputStreamToStr(is);        }catch (IOException e){            logger.error(e.getMessage());        }        return execResStr;    }    /**     * 执行/bin/sh脚本，带-c的命令     * @param cmds     * @return     * @throws IOException 可能找不到命令文件的路径     */    public static String execSubmitShellArray(String cmds) throws IOException{        String [] cmdArray={"/bin/sh","-c",cmds};        Process proc =Runtime.getRuntime().exec(cmdArray);        return inputStreamToStr(proc.getInputStream());    }    /**     * 将输入流转为字符串     * @param is     * @return     * @throws IOException 可能找不到命令文件的路径     */    private static String inputStreamToStr(InputStream is) throws IOException{        byte [] bytes = new byte[1024];        StringBuilder sb = new StringBuilder();        int offset;        while ((offset=is.read(bytes))>-1){            sb.append(new String(bytes,offset));        }        return sb.toString();    }}