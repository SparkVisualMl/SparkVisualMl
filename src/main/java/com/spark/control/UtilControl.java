package com.spark.control;import com.spark.utils.FileUtil;import com.spark.utils.HDFSUtil;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.http.HttpHeaders;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.web.bind.annotation.*;import org.springframework.web.multipart.MultipartFile;import javax.servlet.http.HttpSession;import java.util.Arrays;@RequestMapping(value = "/utils")@RestControllerpublic class UtilControl {    private final Logger logger = LoggerFactory.getLogger(UtilControl.class);    @PostMapping(value = "/uploadjar")    public ResponseEntity uploadJar(@RequestParam("files") MultipartFile fileEntity){        logger.debug("Single file upload!");        if (fileEntity.isEmpty()) {            return new ResponseEntity("please select a file!", HttpStatus.NO_CONTENT);        }        String filePath = FileUtil.saveUploadedFiles(Arrays.asList(fileEntity));        if(!"".equals(filePath)){            return new ResponseEntity("Successfully uploaded - " + fileEntity.getOriginalFilename(), new HttpHeaders(), HttpStatus.OK);        }else {            return new ResponseEntity(HttpStatus.BAD_REQUEST);        }    }    @RequestMapping(value = "/uploadhdfs",method = {RequestMethod.GET,RequestMethod.POST})    public ResponseEntity uploadhdfs(@RequestParam("files") MultipartFile fileEntity){        logger.debug("Single file upload!");        if (fileEntity.isEmpty()) {            return new ResponseEntity("please select a file!", HttpStatus.NO_CONTENT);        }        String filePath = HDFSUtil.saveUploadedFilesToHadoop(Arrays.asList(fileEntity));        if(!"".equals(filePath)){            if(!"exist".equals(filePath)){                return new ResponseEntity("Successfully uploaded - " + fileEntity.getOriginalFilename(), new HttpHeaders(), HttpStatus.OK);            }else {                return new ResponseEntity("file is exist - " + fileEntity.getOriginalFilename(), new HttpHeaders(), HttpStatus.OK);            }        }else {            return new ResponseEntity(HttpStatus.BAD_REQUEST);        }    }}